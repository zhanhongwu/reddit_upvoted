(this.webpackJsonpupvoted=this.webpackJsonpupvoted||[]).push([[0],{56:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"POSTS",(function(){return k})),n.d(r,"posts",(function(){return _})),n.d(r,"AUTH",(function(){return y})),n.d(r,"auth",(function(){return U})),n.d(r,"AUTH_REFRESH",(function(){return R})),n.d(r,"auth_refresh",(function(){return T})),n.d(r,"AUTH_REVOKE",(function(){return C})),n.d(r,"auth_revoke",(function(){return I})),n.d(r,"USER",(function(){return L})),n.d(r,"user",(function(){return A})),n.d(r,"RU_READ",(function(){return P})),n.d(r,"ru_read",(function(){return F})),n.d(r,"RU_WRITE",(function(){return N})),n.d(r,"ru_write",(function(){return M})),n.d(r,"SELECT_PATH",(function(){return H})),n.d(r,"selectPath",(function(){return D})),n.d(r,"RU_LOADMORE",(function(){return W})),n.d(r,"ru_loadMore",(function(){return q})),n.d(r,"SET_UI_SETTING",(function(){return B})),n.d(r,"setUISetting",(function(){return Q})),n.d(r,"SET_SETTING",(function(){return K})),n.d(r,"setSetting",(function(){return z}));var a={};n.r(a),n.d(a,"fetchPostsBySubreddit",(function(){return Ht})),n.d(a,"fetchAuth",(function(){return Wt})),n.d(a,"fetchAuthRefresh",(function(){return qt})),n.d(a,"revokeToken",(function(){return Bt})),n.d(a,"fetchUserIdentity",(function(){return Kt})),n.d(a,"fetchPostsOauth",(function(){return zt}));var c={};n.r(c),n.d(c,"readPage",(function(){return $t})),n.d(c,"writeList",(function(){return Xt}));var s=n(1),o=n.n(s),i=n(29),u=n.n(i),l=(n(56),n(6)),d=n(7),h=n(9),b=n(8),j=n(16),p=n(14),f=n(3),O=n(13),v=(n(61),n(21)),g="REQUEST",m="SUCCESS",x="FAILURE";function S(e){return[g,m,x].reduce((function(t,n){return t[n]="".concat(e,"_").concat(n),t}),{})}function w(e,t){return Object(v.a)({},t,"".concat(e,"_").concat(t))}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(f.a)({type:e},t)}var k=Object(f.a)(Object(f.a)({},S("POSTS")),w("POSTS","INVALIDATE")),_={request:function(e,t){return E(k.REQUEST,{path:e,limit:t})},success:function(e,t){return E(k.SUCCESS,{path:e,response:t})},failure:function(e,t){return E(k.FAILURE,{path:e,error:t})},invalidate:function(e){return E(k.INVALIDATE,{path:e})}},y=Object(f.a)(Object(f.a)({},S("AUTH")),w("AUTH","INIT_SUCCESS")),U={request:function(e){return E(y.REQUEST,{code:e})},success:function(e){return E(y.SUCCESS,{data:e})},failure:function(e){return console.assert("string"===typeof e),E(y.FAILURE,{error:e})},init_success:function(){return E(y.INIT_SUCCESS,{})}},R=S("AUTH_REFRESH"),T={request:function(e){return E(R.REQUEST,{refresh_token:e})},success:function(e){return E(R.SUCCESS,{data:e})},failure:function(e){return E(R.FAILURE,{error:e})}},C=S("AUTH_REVOKE"),I={request:function(){return E(C.REQUEST,{})},success:function(){return E(C.SUCCESS,{})},failure:function(e){return E(C.FAILURE,{error:e})}},L=S("USER"),A={request:function(e){return E(L.REQUEST,{access_token:e})},success:function(e){return E(L.SUCCESS,{data:e})},failure:function(e){return E(L.FAILURE,{error:e})}},P=S("RU_READ"),F={request:function(e,t,n){return E(P.REQUEST,{listname:e,page:t,username:n})},success:function(e,t,n){return E(P.SUCCESS,{listname:e,page:t,data:n})},failure:function(e,t,n){return E(P.FAILURE,{listname:e,page:t,error:n})}},N=Object(f.a)(Object(f.a)({},S("RU_WRITE")),w("RU_WRITE","SET_STATUS")),M={request:function(e,t){return E(N.REQUEST,{listname:e,username:t})},success:function(e,t){return E(N.SUCCESS,{listname:e,data:t})},failure:function(e,t){return E(N.FAILURE,{listname:e,error:t})},setStatus:function(e,t){return E(N.SET_STATUS,{listname:e,status:t})}},H="SELECT_PATH",D=function(e){return E(H,{path:e})},W="RU_LOADMORE",q=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return E(W,{listname:e,page:t,numToLoad:n})},B="SET_UI_SETTING",Q=function(e){return E(B,{setting:e})},K="SET_SETTING",z=function(e){return E(K,{setting:e})},V=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onRouteChange=function(e){var t=e.pathname,n=a.props.dispatch;if(t.startsWith("/viewer")){var c=t.slice("/viewer".length);console.log("PATH CHANGE",c),n(r.selectPath(c))}},e.history.listen(a.onRouteChange),a}return Object(d.a)(n,[{key:"componentWillMount",value:function(){this.onRouteChange(this.props.location)}},{key:"render",value:function(){return null}}]),n}(s.Component),G=Object(O.b)()(V),J=(n(62),n(0)),$=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.text,n=e.to,r=e.active;return Object(J.jsx)(j.b,{className:"DropdownListItem ".concat(r?"DropdownListItem--active":null),to:n,children:t})}}]),n}(s.Component),X=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.links,n=e.title;return Object(J.jsxs)("div",{className:"DropdownList",children:[Object(J.jsx)("p",{className:"DropdownList__title",children:n}),Object(J.jsx)("div",{className:"DropdownList__options",children:t.map((function(e){var t=e.name;return Object(J.jsx)($,Object(f.a)(Object(f.a)({},e),{},{text:t}))}))})]})}}]),n}(s.Component),Y=n(24),Z=["overview","submitted","comments","upvoted","downvoted","hidden","saved","gilded"],ee=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Z.reduce((function(n,r){var a="/viewer/user/".concat(e,"/").concat(r);return[].concat(Object(Y.a)(n),[{name:r,to:a,key:"key_history-".concat(r),active:t&&t.replace(/\/+$/,"")===a}])}),[])},te=["upvoted","saved"],ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return te.reduce((function(t,n){var r="/savehistory/".concat(n);return[].concat(Object(Y.a)(t),[{name:n,to:r,key:"key_savehistory_".concat(n),active:e&&e.replace(/\/+$/,"").includes(r)}])}),[])},re=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.from({length:t},(function(t,r){var a=r+1,c="/savehistory/".concat(e,"/").concat(a);return{name:a.toString(),to:c,key:"key_page_".concat(a),active:n&&n.replace(/\/+$/,"")===c}}))},ae=n(39);n(65),n(66),n(67);function ce(e){return Object.keys(e).map((function(t){return"".concat(t,"=").concat(e[t])})).join("&")}function se(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"".concat(e,"?").concat(ce(t))}function oe(e){return e.includes("/r/")}function ie(){return document.documentElement.clientWidth}function ue(e){var t=e.data,n=t.id,r=t.title,a=t.subreddit,c=t.url,s=t.preview;if(!s)return{id:n,title:r,subreddit:a,url:c};var o=s.images[0],i={source:o.source,resolutions:o.resolutions},u=de([i.source.url].concat(Object(Y.a)(i.resolutions.map((function(e){return e.url}))))),l={commonURL:u,source:Object(f.a)(Object(f.a)({},i.source),{},{url:i.source.url.slice(u.length)}),resolutions:i.resolutions.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{url:e.url.slice(u.length)})}))},d=de(l.resolutions.map((function(e){return e.url}))),h=function(e){return Object(f.a)(Object(f.a)({},e),{},{resolutions:e.resolutions.map((function(e){return e.url}))})}(function(e){var t=e.commonURL,n=e.commonParams,r=e.source,a=e.resolutions;if(4===a.length)return{commonURL:t,commonParams:n,resolutions:a.filter((function(e){return[320,640,1080].includes(e.width)})),source:{width:r.width,height:r.height}};if(3===a.length||2===a.length||1===a.length)return{commonURL:t,commonParams:n,source:r,resolutions:a.filter((function(e){return[320,640].includes(e.width)}))};if(0===a.length)return e}(Object(f.a)(Object(f.a)({},l),{},{commonParams:d,resolutions:l.resolutions.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{url:e.url.slice(d.length)})})).filter((function(e){return 320===e.width||640===e.width||960===e.width||1080===e.width}))}))),b=h.source,j=h.resolutions;return{id:n,subreddit:a,title:r,url:c,preview:[u,d,b,j]}}function le(e){var t=e[2];return{width:t.width,height:t.height}}function de(e){if(!Array.isArray(e))throw new Error("common-prefix expects an array of strings");for(var t=e[0]||"",n=t.length,r=1;r<e.length;++r)for(var a=0;a<n;++a)if(e[r].charAt(a)!==t.charAt(a)){n=a;break}return t.slice(0,n)}n(68);var he=n.p+"static/media/Spinner-1s-200px.1700b373.svg",be=n.p+"static/media/Loading-Dots.3b281720.svg",je=function(e){var t=e.type,n=e.style;return Object(J.jsx)("div",{className:"SpinningWheel",style:n,children:Object(J.jsx)("img",{src:"dots"===t?be:he,alt:"In progress..."})})},pe=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={loaded:!1},r}return Object(d.a)(n,[{key:"render",value:function(){var e=this,t=this.props.data,n=function(e){var t=e[0],n=e[1],r=e[2],a=e[3];return{w320:a[0]?t+n+a[0]:null,w640:a[1]?t+n+a[1]:null,highest:a[2]?t+n+a[2]:r.url?t+r.url:null}}(t.preview),r=n.highest,a=n.w320||r,c=n.w640||r,s=n.highest||r;if(!a)return null;var o="".concat(c," 2x, ").concat(s," 3x"),i=le(t.preview),u=i.height/i.width;if(Number.isNaN(u)||0===u)return console.log("[Post]",t),null;var l="calc(".concat(50*u,"% - 42px)");return Object(J.jsxs)("div",{className:"Post",children:[!this.state.loaded&&Object(J.jsx)("div",{className:"Post__img-placeholder",style:{width:"100%",padding:"".concat(l," 0")},children:Object(J.jsx)(je,{type:"dots"})}),Object(J.jsx)("a",{href:"https://www.reddit.com/".concat(t.id),target:"_blank",children:Object(J.jsx)("img",{src:a,srcSet:o,alt:t.title,style:this.state.loaded?{}:{display:"none"},onLoad:function(){return e.setState({loaded:!0})}})})]})}}]),n}(s.Component),fe=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props.posts;return Object(J.jsx)("div",{className:"PostColumn",children:e.map((function(e){return Object(J.jsx)(pe,{data:e},e.id)}))})}}]),n}(s.Component),Oe=function(e){var t=e.data;return Object(J.jsxs)("div",{className:"TextPost",children:[Object(J.jsx)("p",{className:"TextPost__subreddit",children:"r/".concat(t.subreddit)}),Object(J.jsx)("a",{className:"TextPost__link",href:"https://www.reddit.com/".concat(t.id),target:"_blank",children:t.title}),Object(J.jsx)("p",{className:"TextPost__url",children:t.url})]})},ve=(n(69),function(e){return e.posts.map((function(e){return Object(J.jsx)(Oe,{data:e},e.id)}))}),ge=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.textMode,n=e.posts,r=e.columnCount;if(t)return Object(J.jsx)(ve,{posts:n});for(var a=[],c=0;c<r;c++)a.push({posts:[],totalHeight:0});var s,o=Object(ae.a)(n);try{for(o.s();!(s=o.n()).done;){var i,u=s.value,l=a[0],d=Object(ae.a)(a);try{for(d.s();!(i=d.n()).done;){var h=i.value;h.totalHeight<l.totalHeight&&(l=h)}}catch(j){d.e(j)}finally{d.f()}if(u.preview){l.posts.push(u);var b=le(u.preview);l.totalHeight+=b.height/b.width*320}}}catch(j){o.e(j)}finally{o.f()}return Object(J.jsx)("div",{className:"PostLayout",children:a.map((function(e,t){return Object(J.jsx)(fe,{posts:e.posts},"column_".concat(t))}))})}}]),n}(s.Component),me=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.posts,n=e.columnCount,r=e.textMode;return Object(J.jsx)(o.a.Fragment,{children:Object(J.jsx)(ge,{textMode:r,columnCount:n,posts:t})})}}]),n}(s.Component);var xe=Object(O.b)((function(e){var t=e.UISetting,n=e.Setting;return{columnCount:t.columnCount,textMode:n.textMode}}))(me),Se=n(49),we=n.n(Se),Ee=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).distanceToBottom=function(){var e=document.body,t=document.documentElement;return Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)-(window.innerHeight+window.pageYOffset)},e.scrollHandler=we()((function(){e.distanceToBottom()<=e.props.thresholdBottomPX&&(0,e.props.loadMore)()}),100),e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.loadMore,r=t.fireOnMount,a=t.firePeriodically;document.addEventListener("scroll",this.scrollHandler,{passive:!0}),a&&(this.interval=setInterval((function(){return e.scrollHandler()}),3e3)),r&&n()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("scroll",this.scrollHandler),this.props.firePeriodically&&clearInterval(this.interval)}},{key:"render",value:function(){return null}}]),n}(s.Component),ke=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).getPageStore=function(){var t=e.props,n=t.RU_postsByListname,r=t.listname,a=t.page,c=n[r];return c&&c[a]?c[a]:null},e.requestIfNotExist=function(){var t=e.props,n=t.dispatch,a=t.listname,c=t.page,s=t.userName;e.getPageStore()||n(r.ru_read.request(a,c,s))},e.performLoadMore=function(){var t=e.props,n=t.dispatch,a=t.listname,c=t.page,s=t.columnCount,o=Math.min(100,3*s);n(r.ru_loadMore(a,c,o))},e.loadMoreIfPossible=function(){var t=e.getPageStore();t&&(t.canLoadMore&&e.performLoadMore())},e.loadMoreIfEmpty=function(){var t=e.getPageStore();if(t){var n=t.posts,r=t.canLoadMore;0===n.length&&r&&e.performLoadMore()}},e}return Object(d.a)(n,[{key:"componentDidUpdate",value:function(){this.requestIfNotExist(),this.loadMoreIfEmpty()}},{key:"componentDidMount",value:function(){this.requestIfNotExist(),this.loadMoreIfEmpty()}},{key:"render",value:function(){var e=this.props.textMode,t=this.getPageStore();if(!t)return Object(J.jsx)(je,{});var n=t.isFetching,r=t.posts,a=t.reservoir;return Object(J.jsxs)(o.a.Fragment,{children:[!e&&Object(J.jsx)(Ee,{thresholdBottomPX:1e3,loadMore:this.loadMoreIfPossible}),Object(J.jsx)(xe,{posts:e?r.concat(a):r}),n&&Object(J.jsx)(je,{})]})}}]),n}(s.Component);var _e=Object(O.b)((function(e){var t=e.RU_postsByListname,n=e.UISetting,r=e.Setting;return{RU_postsByListname:t,columnCount:n.columnCount,textMode:r.textMode}}))(ke),ye=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).loadFirstPage=function(){var t=e.props,n=t.dispatch,a=t.RU_postsByListname,c=t.listname,s=t.userName,o=t.location,i=a[c],u=0===o.pathname.replace(/\/+$/,"").split(c)[1].length;!i&&u&&n(r.ru_read.request(c,1,s))},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.loadFirstPage()}},{key:"componentDidUpdate",value:function(){this.loadFirstPage()}},{key:"render",value:function(){var e=this.props,t=e.RU_postsByListname,n=e.listname,r=e.location,a=t[n];if(!a||!a.lengthKnown)return Object(J.jsx)(je,{});if(console.assert(a.lengthKnown,"length should be known"),0===a.length)return Object(J.jsx)("p",{children:"This list is empty. Use the Sync button to sync."});var c=Math.ceil(a.length/100);return Object(J.jsx)(X,{links:re(n,c,r.pathname),title:"Page"})}}]),n}(s.Component);var Ue=Object(O.b)((function(e){return{RU_postsByListname:e.RU_postsByListname}}))(ye),Re=(n(70),function(e){var t=e.onClick;return!e.onClick&&e.to&&(t=function(){window.location.href=e.to}),Object(J.jsx)("button",{className:"Button",onClick:t,children:e.children})}),Te=n.p+"static/media/basic_elaboration_cloud_refresh.895db699.svg",Ce=(n(71),function(e){return Object(J.jsx)("div",{className:"Popup",children:Object(J.jsx)("div",{className:"Popup__box",children:e.children})})}),Ie=(n(72),function(e){return Object(J.jsx)("div",{className:"ButtonGroup",children:e.children})}),Le=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.writeStatus,n=e.closePopupHandler,r=e.tryAgain,a=t.isFetching,c=t.status,s=t.data,i=t.error;return Object(J.jsxs)(o.a.Fragment,{children:[Object(J.jsxs)("p",{children:["Status: ",c]}),i&&Object(J.jsx)("p",{children:"".concat(i.toLowerCase().startsWith("error")?"":"Error: "," ").concat(i)}),s&&s.success&&Object(J.jsx)("p",{children:"Response: ".concat(s.success)}),s&&s.error&&Object(J.jsx)("p",{children:"Request ID: ".concat(s.requestID)}),Object(J.jsxs)(Ie,{children:[!a&&Object(J.jsx)(Re,{onClick:n,children:"OK"}),i&&Object(J.jsx)(Re,{onClick:r,children:"Try Again"})]})]})}}]),n}(s.Component),Ae=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).requestRUWrite=function(){var t=e.props,n=t.dispatch,a=t.listname,c=t.userName;n(r.ru_write.request(a,c))},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.listname,n=e.closePopupHandler,r=e.RU_writeStatusByListname[t];return Object(J.jsx)(Ce,{dismiss:n,children:r?Object(J.jsx)(Le,{writeStatus:r,tryAgain:this.requestRUWrite,closePopupHandler:n}):Object(J.jsxs)(o.a.Fragment,{children:[Object(J.jsx)("h2",{children:"This is what will happen:"}),Object(J.jsxs)("ul",{children:[Object(J.jsxs)("li",{children:["All posts of ",Object(J.jsx)("span",{children:t.toUpperCase()})," will be fetched from Reddit and sent to this app's database."]}),Object(J.jsx)("li",{children:"This app currently cannot delete data saved to its database."})]}),Object(J.jsxs)(Ie,{children:[Object(J.jsx)(Re,{onClick:this.requestRUWrite,children:"Proceed"}),Object(J.jsx)(Re,{onClick:n,children:"Cancel"})]})]})})}}]),n}(s.Component);var Pe=Object(O.b)((function(e){return{RU_writeStatusByListname:e.RU_writeStatusByListname}}))(Ae),Fe=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).closePopupHandler=function(){r.setState({showPopup:!1})},r.state={showPopup:!1},r}return Object(d.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.listname,r=t.userName,a=this.state.showPopup;return Object(J.jsxs)(o.a.Fragment,{children:[Object(J.jsxs)(Re,{onClick:function(){return e.setState({showPopup:!0})},children:[Object(J.jsx)("img",{src:Te,alt:""}),Object(J.jsxs)("span",{children:["Sync ",n.toUpperCase()]})]}),a&&Object(J.jsx)(Pe,{userName:r,listname:n,closePopupHandler:this.closePopupHandler})]})}}]),n}(s.Component),Ne=n.p+"static/media/basic_gear.a5ee7191.svg",Me=(n(73),function(e){return Object(J.jsx)("ul",{className:"SettingList",children:e.children})}),He=function(e){return Object(J.jsx)("li",{className:"SettingListItem",children:e.children})},De=(n(74),function(e){var t=e.labelText,n=e.name,r=e.checked,a=e.onChange;return Object(J.jsxs)("label",{className:"Checkbox",children:[t,Object(J.jsx)("input",{className:"Checkbox__checkbox",type:"checkbox",name:n,onChange:a,checked:r}),Object(J.jsx)("span",{className:"Checkbox__button"})]})}),We=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).closePopupHandler=function(){a.setState({showPopup:!1})},a.handleTextModeChange=function(e){(0,a.props.dispatch)(r.setSetting({textMode:e.target.checked}))},a.state={showPopup:!1},a}return Object(d.a)(n,[{key:"render",value:function(){var e=this,t=this.props.textMode,n=this.state.showPopup;return Object(J.jsxs)(o.a.Fragment,{children:[Object(J.jsx)(Re,{onClick:function(){return e.setState({showPopup:!0})},children:Object(J.jsx)("img",{src:Ne,alt:""})}),n&&Object(J.jsxs)(Ce,{dismiss:this.closePopupHandler,children:[Object(J.jsxs)(Me,{children:[Object(J.jsxs)(He,{children:[Object(J.jsxs)("span",{children:["Navigation:"," "]}),Object(J.jsx)(j.b,{to:"/viewer",children:"Viewer"}),Object(J.jsx)("span",{children:" "}),Object(J.jsx)(j.b,{to:"/savehistory",children:"Save History"})]}),Object(J.jsx)(He,{children:Object(J.jsx)(De,{labelText:"Text Mode:",name:"use-text-mode",checked:t,onChange:this.handleTextModeChange})}),Object(J.jsx)(He,{children:Object(J.jsx)(j.b,{to:"/logout",children:"Log out"})})]}),Object(J.jsx)(Re,{onClick:this.closePopupHandler,children:"OK"})]})]})}}]),n}(s.Component);var qe=Object(O.b)((function(e){return{textMode:e.Setting.textMode}}))(We),Be=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.userName,n=e.location;return t?Object(J.jsxs)(o.a.Fragment,{children:[Object(J.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Object(J.jsx)(X,{links:ne(n.pathname),title:"List"}),Object(J.jsxs)("div",{style:{display:"flex"},children:[Object(J.jsx)(p.b,{path:"/savehistory/:listname",render:function(e){var n=e.match.params.listname;return Object(J.jsx)(Fe,{listname:n,userName:t})}}),Object(J.jsx)(qe,{})]})]}),Object(J.jsx)(p.b,{path:"/savehistory/:listname",render:function(e){var n=e.match.params.listname;return Object(J.jsx)(o.a.Fragment,{children:Object(J.jsx)(Ue,Object(f.a)(Object(f.a)({},e),{},{listname:n,userName:t}))})}}),Object(J.jsx)(p.b,{path:"/savehistory/:listname/:page",exact:!0,render:function(e){var n=e.match.params,r=n.listname,a=n.page;return Object(J.jsx)(_e,{listname:r,page:a,userName:t})}})]}):null}}]),n}(s.Component),Qe=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).requestPosts=function(){var t=e.props,n=t.dispatch,a=t.selectedPath,c=t.isFetching,s=t.endOfList,o=t.columnCount,i=t.textMode;if("/"!==a&&""!==a&&!c&&!s){var u=i?Math.min(100,12*o):Math.min(100,3*o);n(r.posts.request(a,u))}},e.requestPostsIfEmpty=function(){0===e.props.posts.length&&e.requestPosts()},e}return Object(d.a)(n,[{key:"componentDidUpdate",value:function(e){this.props.selectedPath!==e.selectedPath&&this.requestPostsIfEmpty()}},{key:"componentDidMount",value:function(){this.requestPostsIfEmpty()}},{key:"render",value:function(){var e=this.props,t=e.selectedPath,n=e.isFetching,r=e.posts;return"/"===t?null:Object(J.jsxs)(o.a.Fragment,{children:[Object(J.jsx)(Ee,{thresholdBottomPX:1e3,loadMore:this.requestPosts}),Object(J.jsx)(xe,{posts:r}),n&&Object(J.jsx)(je,{})]})}}]),n}(s.Component);var Ke=Object(O.b)((function(e){var t=e.selectedPath,n=e.postsByPath,r=e.UISetting,a=e.Setting,c=n[t]||{};return{selectedPath:t,isFetching:c.isFetching||!1,endOfList:c.endOfList||!1,posts:c.children||[],columnCount:r.columnCount,textMode:a.textMode}}))(Qe),ze=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.userName,n=e.location;return Object(J.jsx)(o.a.Fragment,{children:t&&Object(J.jsxs)(o.a.Fragment,{children:[Object(J.jsx)("header",{children:Object(J.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Object(J.jsx)(X,{links:ee(t,n.pathname),title:"View a list"}),Object(J.jsx)(qe,{})]})}),Object(J.jsx)(Ke,{})]})})}}]),n}(s.Component),Ve=n(50),Ge=n.n(Ve),Je=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).updateWindowDimensions=Ge()((function(){var t,n,a=e.props,c=a.dispatch,s=a.UISetting,o=ie();o>=640?(t=Math.floor(ie()/320),n=!1):o>480?(t=2,n=!0):(t=1,n=!0),t===s.columnCount&&n===s.fullWidth||c(r.setUISetting({columnCount:t,fullWidth:n}))}),50),e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"render",value:function(){return null}}]),n}(s.Component);var $e=Object(O.b)((function(e){return{UISetting:e.UISetting}}))(Je),Xe="CLIENT_KEY",Ye=function(){return null===localStorage.getItem(Xe)&&localStorage.setItem(Xe,Math.random()),localStorage.getItem(Xe)},Ze="AUTH_DATA",et=function(e){localStorage.setItem(Ze,JSON.stringify(e))},tt=function(){return JSON.parse(localStorage.getItem(Ze))},nt="SETTING",rt=function(e){localStorage.setItem(nt,JSON.stringify(e))},at=function(){return JSON.parse(localStorage.getItem(nt))},ct={redirect_uri:"https://zhanhongwu.github.io/reddit_upvoted/authorize_callback",id:"SfDETDfKkJCi8g",basename:"/reddit_upvoted"},st=["history","identity"],ot=(n(75),n(76),function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(J.jsx)("footer",{className:"Footer",children:Object(J.jsx)("div",{className:"Footer__content",children:Object(J.jsx)("p",{className:"Footer__author",children:"by u/zhanhongwut2OUqnqUvc"})})})}}]),n}(s.Component)),it=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props.url;return Object(J.jsxs)(o.a.Fragment,{children:[Object(J.jsx)("div",{className:"LoginPage",children:Object(J.jsxs)("div",{className:"LoginPage__content",children:[Object(J.jsx)("h1",{className:"LoginPage__header",children:"Save your reddit history beyond 1,000 records"}),Object(J.jsx)("a",{className:"LoginPage__button",href:e,children:"Log in via Reddit"}),Object(J.jsx)("p",{style:{marginTop:40},children:"Note: This app is still under development."})]})}),Object(J.jsx)(ot,{})]})}}]),n}(s.Component),ut=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.isFetching,n=e.isLoggedIn,r=e.userName,a=e.UISetting,c=e.location,s=e.history,o=a.fullWidth?"100%":320*a.columnCount;return Object(J.jsxs)("div",{className:"App",children:[Object(J.jsx)(G,{location:c,history:s}),Object(J.jsx)($e,{}),Object(J.jsxs)(p.d,{children:[Object(J.jsx)(p.b,{path:"/savehistory",render:function(e){return n?Object(J.jsx)("div",{style:{width:o},className:"AppContent",children:Object(J.jsx)(Be,Object(f.a)(Object(f.a)({},e),{},{userName:r}))}):Object(J.jsx)(p.a,{to:"/"})}}),Object(J.jsx)(p.b,{path:"/viewer",render:function(e){return Object(J.jsx)("div",{style:{width:o},className:"AppContent",children:Object(J.jsx)(ze,Object(f.a)(Object(f.a)({},e),{},{userName:r}))})}}),Object(J.jsx)(p.b,{path:"/",exact:!0,render:function(e){return t?Object(J.jsx)("p",{children:"Logging in..."}):n?Object(J.jsx)(p.a,{to:"/savehistory"}):Object(J.jsx)(it,{url:se("https://www.reddit.com/api/v1/"+(ie()<=640?"authorize.compact":"authorize"),{client_id:ct.id,response_type:"code",state:Ye(),redirect_uri:ct.redirect_uri,duration:"permanent",scope:st.join(",")})})}}),Object(J.jsx)(p.a,{to:"/"})]})]})}}]),n}(s.Component);var lt=Object(O.b)((function(e){var t=e.auth,n=e.user,r=e.UISetting;return{isFetching:t.isFetching||n.isFetching,isLoggedIn:t.isLoggedIn,userName:n.data.name,UISetting:r}}))(ut),dt=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=new URLSearchParams(this.props.location.search),t=Ye();return e.get("code")&&e.get("state")===t?((0,this.props.dispatch)(r.auth.request(e.get("code"))),Object(J.jsx)(p.a,{to:"/"})):Object(J.jsx)(p.a,{to:"/error"})}}]),n}(s.Component),ht=Object(O.b)()(dt),bt=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.dispatch;e.isLoggedIn&&t(r.auth_revoke.request())}},{key:"render",value:function(){var e=this.props.isLoggedIn;return Object(J.jsxs)("div",{children:[Object(J.jsx)("h1",{children:"Log out"}),e?Object(J.jsx)("p",{children:"Logging out..."}):Object(J.jsxs)("p",{children:["Log out successful. ",Object(J.jsx)(j.b,{to:"/",children:"Homepage"})]})]})}}]),n}(s.Component);var jt=Object(O.b)((function(e){return{isLoggedIn:e.auth.isLoggedIn}}))(bt),pt=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(J.jsxs)("div",{children:[Object(J.jsx)("h1",{children:"Error"}),Object(J.jsx)("p",{children:"Something went wrong"}),Object(J.jsx)(j.b,{to:"/",children:"Return to homepage"})]})}}]),n}(s.Component),ft=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(J.jsx)(j.a,{basename:"/reddit_upvoted",children:Object(J.jsxs)(p.d,{children:[Object(J.jsx)(p.b,{path:"/error",component:pt}),Object(J.jsx)(p.b,{path:"/logout",component:jt}),Object(J.jsx)(p.b,{path:"/authorize_callback",component:ht}),Object(J.jsx)(p.b,{path:"/",component:lt})]})})}}]),n}(s.Component),Ot=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function vt(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var gt=n(22);function mt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=Math.min(e.length,n),a=e.slice(0,r);return{posts:t.concat(a),reservoir:e.slice(r),canLoadMore:e.length>r}}var xt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,posts:[],reservoir:[],canLoadMore:!1,error:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.RU_READ.REQUEST:return Object(f.a)(Object(f.a)({},e),{},{isFetching:!0,error:null});case r.RU_READ.SUCCESS:var n=t.data;return Object(f.a)(Object(f.a)({},e),{},{isFetching:!1,posts:[],reservoir:n.posts,canLoadMore:!0});case r.RU_READ.FAILURE:var a=t.error;return Object(f.a)(Object(f.a)({},e),{},{isFetching:!1,error:a});case r.RU_LOADMORE:console.assert(e.reservoir.length>0,"Cannot load more when reservoir is empty.");var c=t.numToLoad;return Object(f.a)(Object(f.a)({},e),mt(e.reservoir,e.posts,c));default:return e}},St=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.RU_READ.REQUEST:case r.RU_READ.FAILURE:case r.RU_LOADMORE:var n=t.page;return Object(f.a)(Object(f.a)({},e),{},Object(v.a)({},n,xt(e[n]||{isFetching:!1,posts:[],reservoir:[],canLoadMore:!1,error:null},t)));case r.RU_READ.SUCCESS:var a=t.page,c=t.data,s=c.listLength;return console.assert(c.page===a,"page returned by server mismatches"),Object(f.a)(Object(f.a)({},e),{},Object(v.a)({lengthKnown:!0,length:s},a,xt(e[a]||{isFetching:!1,posts:[],reservoir:[],canLoadMore:!1,error:null},t)));default:return e}},wt={isFetching:!1,data:null,error:null,status:""},Et=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.RU_WRITE.REQUEST:return Object(f.a)(Object(f.a)({},wt),{},{isFetching:!0});case r.RU_WRITE.SUCCESS:var n=t.data;return Object(f.a)(Object(f.a)({},e),{},{isFetching:!1,data:n});case r.RU_WRITE.FAILURE:var a=t.error;return Object(f.a)(Object(f.a)({},e),{},{isFetching:!1,error:a});case r.RU_WRITE.SET_STATUS:var c=t.status;return Object(f.a)(Object(f.a)({},e),{},{status:c});default:return e}},kt=function(){return{isFetching:!1,children:[],childrenIdSet:new Set,after:null,endOfList:!1,error:null}};function _t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kt(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.POSTS.REQUEST:return console.assert(!e.endOfList,"should not request after end of list is reached"),Object(f.a)(Object(f.a)({},e),{},{isFetching:!0,error:null});case r.POSTS.SUCCESS:console.assert("Listing"===t.response.kind);var n=t.response.data,a=e.childrenIdSet,c=e.children,s=n.children.map(ue),o=Object(f.a)(Object(f.a)({isFetching:!1},n),{},{children:c.concat(s.filter((function(e){return!a.has(e.id)&&(a.add(e.id),!0)}))),childrenIdSet:a,endOfList:null===n.after});return o.children.length===c.length&&console.assert(o.endOfList,"EndOfList should be set after not adding new post"),o;case r.POSTS.FAILURE:var i=t.error;return Object(f.a)(Object(f.a)({},e),{},{isFetching:!1,error:i});case r.POSTS.INVALIDATE:return kt();default:return e}}var yt={isFetching:!1,isLoggedIn:!1,error:null};var Ut={isFetching:!1,data:{},error:null};var Rt={columnCount:Math.floor(ie()/320),fullWidth:ie()<=640};var Tt={textMode:!1};var Ct=Object(gt.c)({postsByPath:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.POSTS.REQUEST:case r.POSTS.SUCCESS:case r.POSTS.FAILURE:case r.POSTS.INVALIDATE:var n=t.path;return Object(f.a)(Object(f.a)({},e),{},Object(v.a)({},n,_t(e[n]||kt(),t)));default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.AUTH.REQUEST:case r.AUTH_REFRESH.REQUEST:return console.assert(!1===e.isFetching),Object(f.a)(Object(f.a)({},e),{},{isFetching:!0,error:null});case r.AUTH_REFRESH.SUCCESS:case r.AUTH.SUCCESS:var n=t.data,a=n.access_token,c=t.type===r.AUTH.SUCCESS?n:tt(),s=c.refresh_token;return et({access_token:a,refresh_token:s,date_expire:Date.now()+1e3*n.expires_in}),Object(f.a)(Object(f.a)({},e),{},{isFetching:!1,isLoggedIn:!0});case r.AUTH_REFRESH.FAILURE:case r.AUTH.FAILURE:var o=t.error;return Object(f.a)(Object(f.a)({},e),{},{isFetching:!1,isLoggedIn:!1,error:o});case r.AUTH.INIT_SUCCESS:return Object(f.a)(Object(f.a)({},e),{},{isLoggedIn:!0});case r.AUTH_REVOKE.SUCCESS:return et(null),yt;case r.AUTH_REVOKE.FAILURE:var i=t.error;return Object(f.a)(Object(f.a)({},e),{},{error:i});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.USER.REQUEST:return Object(f.a)(Object(f.a)({},e),{},{isFetching:!0,error:null});case r.USER.SUCCESS:var n=t.data;return Object(f.a)(Object(f.a)({},e),{},{isFetching:!1,data:n});case r.USER.FAILURE:var a=t.error;return Object(f.a)(Object(f.a)({},e),{},{isFetching:!1,data:{},error:a});default:return e}},RU_postsByListname:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.RU_READ.REQUEST:case r.RU_READ.SUCCESS:case r.RU_READ.FAILURE:case r.RU_LOADMORE:var n=t.listname;return Object(f.a)(Object(f.a)({},e),{},Object(v.a)({},n,St(e[n]||{lengthKnown:!1,length:0},t)));default:return e}},RU_writeStatusByListname:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.RU_WRITE.REQUEST:case r.RU_WRITE.SUCCESS:case r.RU_WRITE.FAILURE:case r.RU_WRITE.SET_STATUS:var n=t.listname;return Object(f.a)(Object(f.a)({},e),{},Object(v.a)({},n,Et(e[n]||wt,t)));default:return e}},selectedPath:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.SELECT_PATH:var n=t.path;return n;default:return e}},UISetting:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Rt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.SET_UI_SETTING:var n=t.setting;return Object(f.a)(Object(f.a)({},e),n);default:return e}},Setting:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.SET_SETTING:var n=t.setting,a=Object(f.a)(Object(f.a)({},e),n);return rt(a),a;default:return e}}}),It=n(51);var Lt=n(10),At=n.n(Lt),Pt=n(4),Ft=function(e){return e.postsByPath},Nt=n(23),Mt=n.n(Nt);function Ht(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;console.assert(oe(e));var r="https://www.reddit.com".concat(e,".json"),a={after:t,raw_json:1,limit:n};return Mt.a.get(se(r,a))}function Dt(){return{auth:{username:ct.id,password:""}}}function Wt(e){var t={code:e,grant_type:"authorization_code",redirect_uri:ct.redirect_uri};return Mt.a.post("https://www.reddit.com/api/v1/access_token",ce(t),Dt())}function qt(e){var t={grant_type:"refresh_token",refresh_token:e};return Mt.a.post("https://www.reddit.com/api/v1/access_token",ce(t),Dt())}function Bt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="https://www.reddit.com/api/v1/revoke_token",r={token:e,token_type_hint:t?"refresh_token":"access_token"};return Mt.a.post(n,ce(r),Dt())}function Qt(e){return{headers:{Authorization:"bearer ".concat(e)}}}function Kt(e){return Mt.a.get("https://oauth.reddit.com/api/v1/me",Qt(e))}function zt(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;console.assert("/"===t[0]);var a="https://oauth.reddit.com".concat(t),c={after:n,limit:r,raw_json:1};return Mt.a.get(se(a,c),Qt(e))}var Vt="https://eut3s3mrb9.execute-api.us-west-2.amazonaws.com/one",Gt="".concat(Vt,"/read"),Jt="".concat(Vt,"/write");function $t(e,t,n,r){var a={action:"read",page:e,username:t,listname:n,token:r};return Mt.a.post(Gt,a)}function Xt(e,t,n,r){var a={action:"write",posts:e,username:t,listname:n,token:r};return Mt.a.post(Jt,a)}var Yt=At.a.mark(on),Zt=At.a.mark(un),en=At.a.mark(ln),tn=At.a.mark(dn),nn=At.a.mark(hn),rn=At.a.mark(bn),an=At.a.mark(jn),cn=At.a.mark(pn),sn=At.a.mark(fn);function on(e){var t;return At.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(Pt.b)(a.fetchAuthRefresh,e);case 3:if(!(t=n.sent).data.error){n.next=6;break}throw new Error(t.data.error);case 6:return n.abrupt("return",t.data.access_token);case 9:throw n.prev=9,n.t0=n.catch(0),new Error("Cannot get new token.");case 12:case"end":return n.stop()}}),Yt,null,[[0,9]])}function un(e){return At.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Pt.b)(a.revokeToken,e,!1);case 2:case"end":return t.stop()}}),Zt)}function ln(e){return At.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Pt.b)(a.revokeToken,e,!1);case 2:case"end":return t.stop()}}),en)}function dn(e){return At.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Pt.b)(a.revokeToken,e,!0);case 2:case"end":return t.stop()}}),tn)}function hn(){var e,t,n,c,s,o,i,u,l,d,h;return At.a.wrap((function(b){for(;;)switch(b.prev=b.next){case 0:return e=null,b.prev=2,b.next=5,Object(Pt.g)(r.POSTS.REQUEST);case 5:return t=b.sent,n=t.path,c=t.limit,e=n,b.next=11,Object(Pt.f)(Ft);case 11:if(s=b.sent,o=s[n],i=o.endOfList,u=o.after,i){b.next=35;break}if(l=null,!oe(n)){b.next=21;break}return b.next=18,Object(Pt.b)(a.fetchPostsBySubreddit,n,u,c);case 18:l=b.sent,b.next=28;break;case 21:return b.next=23,Object(Pt.b)(tt);case 23:return d=b.sent,h=d.access_token,b.next=27,Object(Pt.b)(a.fetchPostsOauth,h,n,u,c);case 27:l=b.sent;case 28:if(console.log(l.data),!l.data.error){b.next=31;break}throw new Error(l.data.error);case 31:return b.next=33,Object(Pt.d)(r.posts.success(n,l.data));case 33:b.next=36;break;case 35:throw new Error("At end of list.");case 36:b.next=42;break;case 38:return b.prev=38,b.t0=b.catch(2),b.next=42,Object(Pt.d)(r.posts.failure(e,b.t0.toString()));case 42:b.next=0;break;case 44:case"end":return b.stop()}}),nn,null,[[2,38]])}function bn(){var e,t,n;return At.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=1,c.next=4,Object(Pt.g)(r.AUTH.REQUEST);case 4:return e=c.sent,t=e.code,c.next=8,Object(Pt.b)(a.fetchAuth,t);case 8:if(!(n=c.sent).data.error){c.next=11;break}throw new Error(n.data.error);case 11:return c.next=13,Object(Pt.d)(r.auth.success(n.data));case 13:return c.next=15,Object(Pt.d)(r.user.request(n.data.access_token));case 15:c.next=21;break;case 17:return c.prev=17,c.t0=c.catch(1),c.next=21,Object(Pt.d)(r.auth.failure(c.t0.toString()));case 21:c.next=0;break;case 23:case"end":return c.stop()}}),rn,null,[[1,17]])}function jn(){var e,t,n,c,s;return At.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=1,o.next=4,Object(Pt.g)(r.AUTH_REFRESH.REQUEST);case 4:return e=o.sent,t=e.refresh_token,o.next=8,Object(Pt.b)(a.fetchAuthRefresh,t);case 8:if(!(n=o.sent).data.error){o.next=11;break}throw new Error(n.data.error);case 11:return o.next=13,Object(Pt.b)(tt);case 13:return c=o.sent,s=c.access_token,o.next=17,Object(Pt.d)(r.auth_refresh.success(n.data));case 17:return o.next=19,Object(Pt.c)(ln,s);case 19:return o.next=21,Object(Pt.d)(r.user.request(n.data.access_token));case 21:o.next=27;break;case 23:return o.prev=23,o.t0=o.catch(1),o.next=27,Object(Pt.d)(r.auth_refresh.failure(o.t0.toString()));case 27:o.next=0;break;case 29:case"end":return o.stop()}}),an,null,[[1,23]])}function pn(){var e,t,n;return At.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=1,a.next=4,Object(Pt.g)(r.AUTH_REVOKE.REQUEST);case 4:return e=tt(),t=e.access_token,n=e.refresh_token,a.next=7,Object(Pt.a)([Object(Pt.b)(ln,t),Object(Pt.b)(dn,n)]);case 7:return a.next=9,Object(Pt.d)(r.auth_revoke.success());case 9:a.next=15;break;case 11:return a.prev=11,a.t0=a.catch(1),a.next=15,Object(Pt.d)(r.auth_revoke.failure(a.t0.toString()));case 15:a.next=0;break;case 17:case"end":return a.stop()}}),cn,null,[[1,11]])}function fn(){var e,t,n;return At.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=1,c.next=4,Object(Pt.g)(r.USER.REQUEST);case 4:return e=c.sent,t=e.access_token,c.next=8,Object(Pt.b)(a.fetchUserIdentity,t);case 8:if(!(n=c.sent).data.error){c.next=11;break}throw new Error(n.data.error);case 11:return c.next=13,Object(Pt.d)(r.user.success(n.data));case 13:c.next=19;break;case 15:return c.prev=15,c.t0=c.catch(1),c.next=19,Object(Pt.d)(r.user.failure(c.t0.toString()));case 19:c.next=0;break;case 21:case"end":return c.stop()}}),sn,null,[[1,15]])}var On=At.a.mark(wn),vn=At.a.mark(En),gn=At.a.mark(kn),mn=At.a.mark(_n),xn=At.a.mark(yn),Sn=At.a.mark(Un);function wn(e){var t,n,a,s,o,i,u,l;return At.a.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if(d.prev=0,s=e.username,t=e.listname,n=e.page,o=tt(),i=o.refresh_token){d.next=7;break}throw new Error("Canno find token for RU read.");case 7:return d.next=9,on(i);case 9:return a=d.sent,d.next=12,Object(Pt.b)(c.readPage,n,s,t,a);case 12:if(u=d.sent,console.log(u),!u.data.error){d.next=16;break}throw new Error(u.data.error);case 16:return l=r.ru_read.success(t,n,u.data),d.next=19,Object(Pt.d)(l);case 19:d.next=25;break;case 21:return d.prev=21,d.t0=d.catch(0),d.next=25,Object(Pt.d)(r.ru_read.failure(t,n,d.t0.toString()));case 25:if(d.prev=25,!a){d.next=29;break}return d.next=29,Object(Pt.c)(un,a);case 29:return d.finish(25);case 30:case"end":return d.stop()}}),On,null,[[0,21,25,30]])}function En(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Pt.h)(r.RU_READ.REQUEST,wn);case 2:case"end":return e.stop()}}),vn)}function kn(e,t){var n,a;return At.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:n=0;case 1:return c.next=4,Object(Pt.f)(Ft);case 4:if(!(a=c.sent)[e]||!a[e].endOfList){c.next=7;break}return c.abrupt("break",22);case 7:return c.next=9,Object(Pt.d)(r.ru_write.setStatus(t,"Fetched ".concat(a[e].children.length," posts.")));case 9:if(a[e]&&a[e].isFetching){c.next=13;break}return c.next=12,Object(Pt.d)(r.posts.request(e,100));case 12:n+=1;case 13:return c.next=15,Object(Pt.g)([r.POSTS.SUCCESS,r.POSTS.FAILURE]);case 15:if(c.sent.type!==r.POSTS.FAILURE){c.next=18;break}throw new Error("Request number ".concat(n+1," went wrong"));case 18:if(!(n>=11)){c.next=20;break}return c.abrupt("break",22);case 20:c.next=1;break;case 22:case"end":return c.stop()}}),gn)}function _n(e){var t;return At.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=3,Object(Pt.g)(r.POSTS.INVALIDATE);case 3:if((t=n.sent).path!==e){n.next=6;break}return n.abrupt("return",t);case 6:n.next=0;break;case 8:case"end":return n.stop()}}),mn)}function yn(e,t){var n,a;return At.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(Pt.f)(Ft);case 2:if(!(n=c.sent)[e]||!n[e].isFetching){c.next=5;break}throw new Error("Cannot start in the progress of another request");case 5:return c.next=7,Object(Pt.d)(r.posts.invalidate(e));case 7:return c.next=9,Object(Pt.e)({invalidated:Object(Pt.b)(_n,e),workDone:Object(Pt.b)(kn,e,t)});case 9:if(a=c.sent,!a.invalidated){c.next=13;break}throw new Error("Interrupted by invalidation");case 13:case"end":return c.stop()}}),xn)}function Un(){var e,t,n,a,s,o,i,u,l,d;return At.a.wrap((function(h){for(;;)switch(h.prev=h.next){case 0:return e=void 0,t=void 0,h.prev=3,h.next=6,Object(Pt.g)(r.RU_WRITE.REQUEST);case 6:return n=h.sent,a=n.username,e=n.listname,h.next=11,Object(Pt.d)(r.ru_write.setStatus(e,"Initializing"));case 11:return s="/user/".concat(a,"/").concat(e),h.next=14,Object(Pt.b)(yn,s,e);case 14:return h.next=16,Object(Pt.f)(Ft);case 16:if(o=h.sent,0!==(i=Object(Y.a)(o[s].children).reverse().slice(0,1e3)).length){h.next=20;break}throw new Error("There are no posts to save.");case 20:if(u=tt(),l=u.refresh_token){h.next=23;break}throw new Error("Cannot find token for RU write.");case 23:return h.next=25,on(l);case 25:return t=h.sent,h.next=28,Object(Pt.d)(r.ru_write.setStatus(e,"Writing ".concat(i.length," to database")));case 28:return h.next=30,Object(Pt.b)(c.writeList,i,a,e,t);case 30:return d=h.sent,h.next=33,Object(Pt.d)(r.ru_write.success(e,d.data));case 33:if(!d.data.error){h.next=37;break}throw new Error(d.data.error);case 37:return h.next=39,Object(Pt.d)(r.ru_write.setStatus(e,"Success."));case 39:h.next=47;break;case 41:return h.prev=41,h.t0=h.catch(3),h.next=45,Object(Pt.d)(r.ru_write.setStatus(e,"An error happened."));case 45:return h.next=47,Object(Pt.d)(r.ru_write.failure(e,h.t0.toString()));case 47:if(h.prev=47,!t){h.next=51;break}return h.next=51,Object(Pt.c)(un,t);case 51:return h.finish(47);case 52:h.next=0;break;case 54:case"end":return h.stop()}}),Sn,null,[[3,41,47,52]])}var Rn=At.a.mark(Pn),Tn=At.a.mark(Fn),Cn=At.a.mark(Nn),In=At.a.mark(Mn),Ln=At.a.mark(Hn),An=18e5;function Pn(e){var t;return At.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=function(e){return new Promise((function(t){return setTimeout(t,e)}))};case 1:return n.next=4,Object(Pt.b)(t,An);case 4:return n.next=6,Object(Pt.d)(r.auth_refresh.request(e));case 6:n.next=1;break;case 8:case"end":return n.stop()}}),Rn)}function Fn(){var e,t;return At.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Pt.b)(tt);case 2:if(e=n.sent){n.next=5;break}return n.abrupt("return");case 5:return n.next=7,Object(Pt.d)(r.auth.init_success());case 7:if(!(e.date_expire-Date.now()<An)){n.next=12;break}return n.next=10,Object(Pt.d)(r.auth_refresh.request(e.refresh_token));case 10:n.next=15;break;case 12:return t=e.access_token,n.next=15,Object(Pt.d)(r.user.request(t));case 15:return n.next=17,Object(Pt.c)(Pn,e.refresh_token);case 17:case"end":return n.stop()}}),Tn)}function Nn(){var e;return At.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Pt.b)(at);case 2:if(e=t.sent){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,Object(Pt.d)(r.setSetting(e));case 7:case"end":return t.stop()}}),Cn)}function Mn(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Pt.c)(Fn);case 2:return e.next=4,Object(Pt.c)(Nn);case 4:case"end":return e.stop()}}),In)}function Hn(){return At.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Pt.c)(hn);case 2:return e.next=4,Object(Pt.c)(bn);case 4:return e.next=6,Object(Pt.c)(jn);case 6:return e.next=8,Object(Pt.c)(pn);case 8:return e.next=10,Object(Pt.c)(fn);case 10:return e.next=12,Object(Pt.c)(En);case 12:return e.next=14,Object(Pt.c)(Un);case 14:return e.next=16,Object(Pt.c)(Mn);case 16:case"end":return e.stop()}}),Ln)}var Dn=function(){var e=Object(It.a)(),t=gt.d,n=Object(gt.e)(Ct,t(Object(gt.a)(e)));return Object(f.a)(Object(f.a)({},n),{},{runSaga:e.run})}();Dn.runSaga(Hn),u.a.render(Object(J.jsx)(O.a,{store:Dn,children:Object(J.jsx)(ft,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/reddit_upvoted",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/reddit_upvoted","/service-worker.js");Ot?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):vt(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):vt(t,e)}))}}()}},[[97,1,2]]]);